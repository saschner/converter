<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Image to Excel Converter</title>
    <style>
        body {
	    text-align: center;
            padding: 20px;
            background-image: url('dataimage.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            min-height: 100vh;
       }
.merriweather-MyFont {
  font-family: "Merriweather", serif;
  font-optical-sizing: auto;
  font-weight: 500;
  font-style: normal;
  font-variation-settings:
    "wdth" 100;
}
        .content-box {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background: radial-gradient(circle, white, #E6F0FA);
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 1);
        }
        #dropZone {
            border: 2px dashed #ccc;
            padding: 20px;
            margin: 20px auto;
            width: 80%;
            max-width: 500px;
            cursor: pointer;
            background-color: rgba(255, 255, 255, 1.0);
        }
        #paymentSection {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            flex-wrap: nowrap;
        }
        .payment-button {
            padding: 10px 20px;
            border: none;
            cursor: pointer;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 150px;
            text-align: center;
            font-size: 16px;
        }
        #convertButton {
            background-color: #4CAF50;
        }
        #convertButton:hover {
            background-color: #45a049;
        }
        #stripe-checkout-button {
            background-color: #6772E5;
        }
        #kofi-button {
            background-color: #FF5E5B;
        }
        #kofi-button:hover {
            background-color: #e05553;
        }
        /* Ensure form doesn't disrupt flex layout */
        #paymentSection form {
            display: contents;
        }
    </style>
</head>
<body>
    <div class="content-box">
        <h1>Local Image to Excel Converter</h1>
        <p>Process images LOCALLY - 100% private, NO data sent to servers!</p>
        
        <div id="dropZone">
            Drag & drop your image here or <font color="#FF0000"><I>click here</I></font> to select
            <input type="file" id="imageInput" accept="image/*" style="display: none;">
        </div>
        
        <div id="paymentSection">
            <!-- Convert Button -->
            <button id="convertButton" class="payment-button">Convert to CSV</button>
            
            <!-- Stripe Button -->
            <form action="/create-checkout-session" method="POST">
                <button type="submit" id="stripe-checkout-button" class="payment-button">
                    Buy Bulk Usage (Stripe)
                </button>
            </form>
            
            <!-- Ko-Fi Button -->
            <a href="https://ko-fi.com/excelconverter" id="kofi-button" class="payment-button">Buy Us a Coffee! â˜•</a>
        </div>
    </div>

    <!-- Stripe SDK -->
    <script src="https://js.stripe.com/v3/"></script>
    <script>
        // Note: The actual redirect to Stripe Checkout requires server-side handling
        // This form submission assumes a backend endpoint /create-checkout-session
        document.getElementById('stripe-checkout-button').addEventListener('click', function(e) {
            // Prevent default form submission (handled by backend)
            e.preventDefault();
            fetch('/create-checkout-session', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    items: [{ id: 'bulk_usage', quantity: 1 }],
                    success_url: 'https://example.com/success',
                    cancel_url: 'https://example.com/cancel'
                })
            })
            .then(response => response.json())
            .then(session => {
                const stripe = Stripe('mxwn-bfyf-xmfi-fald-vyoo');
                return stripe.redirectToCheckout({ sessionId: session.id });
            })
            .then(result => {
                if (result.error) {
                    alert(result.error.message);
                }
            })
            .catch(error => {
                console.error('Stripe Checkout Error:', error);
                alert('An error occurred with Stripe. Please try again or contact support.');
            });
        });
    </script>

    <script>
        const dropZone = document.getElementById('dropZone');
        const imageInput = document.getElementById('imageInput');
        const convertButton = document.getElementById('convertButton');

        dropZone.addEventListener('click', () => imageInput.click());
        
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.style.backgroundColor = '#e1e1e1';
        });
        
        dropZone.addEventListener('dragleave', () => {
            dropZone.style.backgroundColor = 'transparent';
        });
        
        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.style.backgroundColor = 'transparent';
            imageInput.files = e.dataTransfer.files;
        });
        
        convertButton.addEventListener('click', () => {
            if (imageInput.files.length > 0) {
                alert('Converting ' + imageInput.files[0].name + ' to CSV!');
                // Add conversion logic here
            } else {
                alert('Please select an image first!');
            }
        });
    </script>
<div class="footer">
                <p>&copy; 2025 AlphaMinds AI. All rights reserved.</p>
            </div>
</body>
</html>